/*
Copyright (c) 2019 Daybrush
name: @scena/guides
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/guides.git
version: 0.4.2
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Guides=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function p(e,n){return function(t){t&&(e[n]=t)}}var b,l,e,n,s,C={},w=[],r=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord/i;function P(t,e){for(var n in e)t[n]=e[n];return t}function m(t){var e=t.parentNode;e&&e.removeChild(t)}function h(t,e,n){var i,o=arguments,r={};for(i in e)"key"!==i&&"ref"!==i&&(r[i]=e[i]);if(3<arguments.length)for(n=[n],i=3;i<arguments.length;i++)n.push(o[i]);if(null!=n&&(r.children=n),"function"==typeof t&&null!=t.defaultProps)for(i in t.defaultProps)void 0===r[i]&&(r[i]=t.defaultProps[i]);return a(t,r,e&&e.key,e&&e.ref)}function a(t,e,n,i){var o={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:null,__c:null,constructor:void 0};return b.vnode&&b.vnode(o),o}function k(t){return t.children}function E(t,e){this.props=t,this.context=e}function y(t,e){if(null==e)return t.__?y(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?y(t):null}function u(t){var e,n;if(null!=(t=t.__)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return u(t)}}function c(t){(!t.__d&&(t.__d=!0)&&1===l.push(t)||n!==b.debounceRendering)&&((n=b.debounceRendering)||e)(f)}function f(){var t,e,n,i,o,r,s;for(l.sort(function(t,e){return e.__v.__b-t.__v.__b});t=l.pop();)t.__d&&(i=n=void 0,r=(o=(e=t).__v).__e,(s=e.__P)&&(n=[],i=S(s,o,P({},o),e.__n,void 0!==s.ownerSVGElement,null,n,null==r?y(o):r),v(n,o),i!=r&&u(o)))}function x(e,n,t,i,o,r,s,l,a){var u,c,f,p,h,_,d,v=t&&t.__k||w,g=v.length;if(l==C&&(l=null!=r?r[0]:g?y(t,0):null),u=0,n.__k=O(n.__k,function(t){if(null!=t){if(t.__=n,t.__b=n.__b+1,null===(f=v[u])||f&&t.key==f.key&&t.type===f.type)v[u]=void 0;else for(c=0;c<g;c++){if((f=v[c])&&t.key==f.key&&t.type===f.type){v[c]=void 0;break}f=null}if(p=S(e,t,f=f||C,i,o,r,s,l,a),(c=t.ref)&&f.ref!=c&&(d=d||[],f.ref&&d.push(f.ref,null,t),d.push(c,t.__c||p,t)),null!=p){if(null==_&&(_=p),null!=t.__d)p=t.__d,t.__d=null;else if(r==f||p!=l||null==p.parentNode){t:if(null==l||l.parentNode!==e)e.appendChild(p);else{for(h=l,c=0;(h=h.nextSibling)&&c<g;c+=2)if(h==p)break t;e.insertBefore(p,l)}"option"==n.type&&(e.value="")}l=p.nextSibling,"function"==typeof n.type&&(n.__d=p)}}return u++,t}),n.__e=_,null!=r&&"function"!=typeof n.type)for(u=r.length;u--;)null!=r[u]&&m(r[u]);for(u=g;u--;)null!=v[u]&&j(v[u],v[u]);if(d)for(u=0;u<d.length;u++)N(d[u],d[++u],d[++u])}function O(t,e,n){if(null==n&&(n=[]),null==t||"boolean"==typeof t)e&&n.push(e(null));else if(Array.isArray(t))for(var i=0;i<t.length;i++)O(t[i],e,n);else n.push(e?e("string"==typeof t||"number"==typeof t?a(null,t,null,null):null!=t.__e||null!=t.__c?a(t.type,t.props,t.key,null):t):t);return n}function _(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]="number"==typeof n&&!1===r.test(e)?n+"px":null==n?"":n}function D(t,e,n,i,o){var r,s,l,a,u;if(o?"className"===e&&(e="class"):"class"===e&&(e="className"),"key"!==e&&"children"!==e)if("style"===e)if(r=t.style,"string"==typeof n)r.cssText=n;else{if("string"==typeof i&&(r.cssText="",i=null),i)for(s in i)n&&s in n||_(r,s,"");if(n)for(l in n)i&&n[l]===i[l]||_(r,l,n[l])}else"o"===e[0]&&"n"===e[1]?(a=e!==(e=e.replace(/Capture$/,"")),e=((u=e.toLowerCase())in t?u:e).slice(2),n?(i||t.addEventListener(e,d,a),(t.l||(t.l={}))[e]=n):t.removeEventListener(e,d,a)):"list"!==e&&"tagName"!==e&&"form"!==e&&"type"!==e&&!o&&e in t?t[e]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==n||!1===n?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):null==n||!1===n?t.removeAttribute(e):t.setAttribute(e,n))}function d(t){this.l[t.type](b.event?b.event(t):t)}function S(t,e,n,i,o,r,s,l,a){var u,c,f,p,h,_,d,v,g,m,y=e.type;if(void 0!==e.constructor)return null;(u=b.__b)&&u(e);try{t:if("function"==typeof y){if(v=e.props,g=(u=y.contextType)&&i[u.__c],m=u?g?g.props.value:u.__:i,n.__c?d=(c=e.__c=n.__c).__=c.__E:("prototype"in y&&y.prototype.render?e.__c=c=new y(v,m):(e.__c=c=new E(v,m),c.constructor=y,c.render=z),g&&g.sub(c),c.props=v,c.state||(c.state={}),c.context=m,c.__n=i,f=c.__d=!0,c.__h=[]),null==c.__s&&(c.__s=c.state),null!=y.getDerivedStateFromProps&&(c.__s==c.state&&(c.__s=P({},c.__s)),P(c.__s,y.getDerivedStateFromProps(v,c.__s))),p=c.props,h=c.state,f)null==y.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==y.getDerivedStateFromProps&&v!==p&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(v,m),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(v,c.__s,m)){for(c.props=v,c.state=c.__s,c.__d=!1,(c.__v=e).__e=n.__e,e.__k=n.__k,c.__h.length&&s.push(c),u=0;u<e.__k.length;u++)e.__k[u]&&(e.__k[u].__=e);break t}null!=c.componentWillUpdate&&c.componentWillUpdate(v,c.__s,m),null!=c.componentDidUpdate&&c.__h.push(function(){c.componentDidUpdate(p,h,_)})}c.context=m,c.props=v,c.state=c.__s,(u=b.__r)&&u(e),c.__d=!1,c.__v=e,c.__P=t,u=c.render(c.props,c.state,c.context),e.__k=O(null!=u&&u.type==k&&null==u.key?u.props.children:u),null!=c.getChildContext&&(i=P(P({},i),c.getChildContext())),f||null==c.getSnapshotBeforeUpdate||(_=c.getSnapshotBeforeUpdate(p,h)),x(t,e,n,i,o,r,s,l,a),c.base=e.__e,c.__h.length&&s.push(c),d&&(c.__E=c.__=null),c.__e=null}else e.__e=function(t,e,n,i,o,r,s,l){var a,u,c,f,p,h=n.props,_=e.props;if(o="svg"===e.type||o,null==t&&null!=r)for(a=0;a<r.length;a++)if(null!=(u=r[a])&&(null===e.type?3===u.nodeType:u.localName===e.type)){t=u,r[a]=null;break}if(null==t){if(null===e.type)return document.createTextNode(_);t=o?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),r=null}if(null===e.type)null!=r&&(r[r.indexOf(t)]=null),h!==_&&t.data!=_&&(t.data=_);else if(e!==n){if(null!=r&&(r=w.slice.call(t.childNodes)),c=(h=n.props||C).dangerouslySetInnerHTML,f=_.dangerouslySetInnerHTML,!l){if(h===C)for(h={},p=0;p<t.attributes.length;p++)h[t.attributes[p].name]=t.attributes[p].value;(f||c)&&(f&&c&&f.__html==c.__html||(t.innerHTML=f&&f.__html||""))}(function(t,e,n,i,o){var r;for(r in n)r in e||D(t,r,null,n[r],i);for(r in e)o&&"function"!=typeof e[r]||"value"===r||"checked"===r||n[r]===e[r]||D(t,r,e[r],n[r],i)})(t,_,h,o,l),e.__k=e.props.children,f||x(t,e,n,i,"foreignObject"!==e.type&&o,r,s,C,l),l||("value"in _&&void 0!==_.value&&_.value!==t.value&&(t.value=null==_.value?"":_.value),"checked"in _&&void 0!==_.checked&&_.checked!==t.checked&&(t.checked=_.checked))}return t}(n.__e,e,n,i,o,r,s,a);(u=b.diffed)&&u(e)}catch(t){b.__e(t,e,n)}return e.__e}function v(t,e){b.__c&&b.__c(e,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(t){t.call(e)})}catch(t){b.__e(t,e.__v)}})}function N(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){b.__e(t,n)}}function j(t,e,n){var i,o,r;if(b.unmount&&b.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||N(i,null,e)),n||"function"==typeof t.type||(n=null!=(o=t.__e)),t.__e=t.__d=null,null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(t){b.__e(t,e)}i.base=i.__P=null}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&j(i[r],e,n);null!=o&&m(o)}function z(t,e,n){return this.constructor(t,n)}function g(t,e,n){var i,o,r;b.__&&b.__(t,e),o=(i=n===s)?null:n&&n.__k||e.__k,t=h(k,null,[t]),r=[],S(e,(i?e:n||e).__k=t,o||C,C,void 0!==e.ownerSVGElement,n&&!i?[n]:o?null:w.slice.call(e.childNodes),r,n||C,i),v(r,t)}b={__e:function(t,e){for(var n,i;e=e.__;)if((n=e.__c)&&!n.__)try{if(n.constructor&&null!=n.constructor.getDerivedStateFromError&&(i=!0,n.setState(n.constructor.getDerivedStateFromError(t))),null!=n.componentDidCatch&&(i=!0,n.componentDidCatch(t)),i)return c(n.__E=n)}catch(e){t=e}throw t}},E.prototype.setState=function(t,e){var n;n=this.__s!==this.state?this.__s:this.__s=P({},this.state),"function"==typeof t&&(t=t(n,this.props)),t&&P(n,t),null!=t&&this.__v&&(this.__e=!1,e&&this.__h.push(e),c(this))},E.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),c(this))},E.prototype.render=k,l=[],e="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,s=C;var T,X,Y=["setGuides","type","width","height","rulerStyle","unit","zoom","style","backgroundColor","lineColor","container","className","textColor"],G=[],M=b.__r,A=b.diffed,F=b.__c,R=b.unmount;function L(){G.some(function(t){t.__P&&(t.__H.u.forEach(U),t.__H.u.forEach(W),t.__H.u=[])}),G=[]}function U(t){t.m&&t.m()}function W(t){var e=t.i();"function"==typeof e&&(t.m=e)}function H(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var i in e)if("__source"!==i&&t[i]!==e[i])return!0;return!1}b.__r=function(t){M&&M(t),(T=t.__c).__H&&(T.__H.u.forEach(U),T.__H.u.forEach(W),T.__H.u=[])},b.diffed=function(t){A&&A(t);var e=t.__c;if(e){var n=e.__H;n&&n.u.length&&(1!==G.push(e)&&X===b.requestAnimationFrame||((X=b.requestAnimationFrame)||function(t){function e(){clearTimeout(i),cancelAnimationFrame(n),setTimeout(t)}var n,i=setTimeout(e,100);"undefined"!=typeof window&&(n=requestAnimationFrame(e))})(L))}},b.__c=function(t,e){e.some(function(t){t.__h.forEach(U),t.__h=t.__h.filter(function(t){return!t.i||W(t)})}),F&&F(t,e)},b.unmount=function(t){R&&R(t);var e=t.__c;if(e){var n=e.__H;n&&n.t.forEach(function(t){return t.m&&t.m()})}};var $,t,I,q=(I=$=E,(t=B).prototype=Object.create(I.prototype),(t.prototype.constructor=t).__proto__=I,B.prototype.shouldComponentUpdate=function(t,e){return H(this.props,t)||H(this.state,e)},B);function B(t){var e;return(e=$.call(this,t)||this).isPureReactComponent=!0,e}var V=b.vnode;b.vnode=function(t){t.type&&t.type.t&&t.ref&&(t.props.ref=t.ref,t.ref=null),V&&V(t)};var Z=b.__e;function J(t){return t&&((t=function(t,e){for(var n in e)t[n]=e[n];return t}({},t)).__c=null,t.__k=t.__k&&t.__k.map(J)),t}function K(t){var e=t.__.__c;return e&&e.o&&e.o(t)}b.__e=function(t,e,n){if(t.then)for(var i,o=e;o=o.__;)if((i=o.__c)&&i.l)return i.l(t,e.__c);Z(t,e,n)},(new E).l=function(t,e){function n(){r||(r=!0,o?o(s):s())}var i=this,o=K(i.__v),r=!1;e.__c=e.componentWillUnmount,e.componentWillUnmount=function(){n(),e.__c&&e.__c()};var s=function(){--i.__u||(i.__v.__k[0]=i.state.o,i.setState({o:i.__b=null}))};i.__u++||i.setState({o:i.__b=i.__v.__k[0]}),t.then(n,n)};function Q(t,e,n){if(++n[1]===n[0]&&t.i.delete(e),t.props.revealOrder&&("t"!==t.props.revealOrder[0]||!t.i.size))for(n=t.u;n;){for(;3<n.length;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}}(new E).o=function(n){var i=this,o=K(i.__v),r=i.i.get(n);return r[0]++,function(t){function e(){i.props.revealOrder?(r.push(t),Q(i,n,r)):t()}o?o(e):e()}};var tt,et=((tt=nt.prototype).getChildContext=function(){return this.props.context},tt.render=function(t){return t.children},nt);function nt(){}function it(t){var e=this,n=t.container,i=h(et,{context:e.context},t.vnode);return e.s&&e.s!==n&&(e.h.parentNode&&e.s.removeChild(e.h),j(e.v),e.p=!1),t.vnode?e.p?(n.__k=e.__k,g(i,n),e.__k=n.__k):(e.h=document.createTextNode(""),function(t,e){g(t,e,s)}("",n),n.appendChild(e.h),e.p=!0,g(i,e.s=n,e.h),e.__k=this.h.__k):e.p&&(e.h.parentNode&&e.s.removeChild(e.h),j(e.v)),e.v=i,e.componentWillUnmount=function(){e.h.parentNode&&e.s.removeChild(e.h),j(e.v)},null}var ot=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/;E.prototype.isReactComponent={};var rt="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,st=b.event;function lt(t,e){t["UNSAFE_"+e]&&!t[e]&&Object.defineProperty(t,e,{configurable:!1,get:function(){return this["UNSAFE_"+e]},set:function(t){this["UNSAFE_"+e]=t}})}b.event=function(t){return st&&(t=st(t)),t.persist=function(){},t.nativeEvent=t};var at={configurable:!0,get:function(){return this.class}},ut=b.vnode;b.vnode=function(r){r.$$typeof=rt;var t=r.type,e=r.props;if("function"!=typeof t){var n,i,o;for(o in e.defaultValue&&(e.value||0===e.value||(e.value=e.defaultValue),delete e.defaultValue),Array.isArray(e.value)&&e.multiple&&"select"===t&&(O(e.children).forEach(function(t){-1!=e.value.indexOf(t.props.value)&&(t.props.selected=!0)}),delete e.value),e)if(n=ot.test(o))break;if(n)for(o in i=r.props={},e)i[ot.test(o)?o.replace(/([A-Z0-9])/,"-$1").toLowerCase():o]=e[o]}(e.class||e.className)&&(at.enumerable="className"in e,e.className&&(e.class=e.className),Object.defineProperty(e,"className",at)),function(){var t=r.type,e=r.props;if(e&&"string"==typeof t){var n={};for(var i in e)/^on(Ani|Tra|Tou)/.test(i)&&(e[i.toLowerCase()]=e[i],delete e[i]),n[i.toLowerCase()]=i;if(n.ondoubleclick&&(e.ondblclick=e[n.ondoubleclick],delete e[n.ondoubleclick]),n.onbeforeinput&&(e.onbeforeinput=e[n.onbeforeinput],delete e[n.onbeforeinput]),n.onchange&&("textarea"===t||"input"===t.toLowerCase()&&!/^fil|che|ra/i.test(e.type))){var o=n.oninput||"oninput";e[o]||(e[o]=e[n.onchange],delete e[n.onchange])}}}(),"function"==typeof t&&!t.m&&t.prototype&&(lt(t.prototype,"componentWillMount"),lt(t.prototype,"componentWillReceiveProps"),lt(t.prototype,"componentWillUpdate"),t.m=!0),ut&&ut(r)};var ct=function(t,e){return(ct=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scrollPos:0},t.width=0,t.height=0,t}!function(t,e){function n(){this.constructor=t}ct(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e);var n=t.prototype;return n.render=function(){return h("canvas",{ref:p(this,"canvasElement"),style:this.props.style})},n.componentDidMount=function(){var t=this.canvasElement.getContext("2d");this.canvasContext=t,this.resize()},n.componentDidUpdate=function(){this.resize()},n.scroll=function(t){this.draw(t)},n.resize=function(){var t=this.canvasElement,e=this.props,n=e.width,i=e.height;this.width=n||t.offsetWidth,this.height=i||t.offsetHeight,t.width=2*this.width,t.height=2*this.height,this.draw()},n.draw=function(t){void 0===t&&(t=this.state.scrollPos);var e=this.props,n=e.unit,i=e.zoom,o=e.type,r=e.backgroundColor,s=e.lineColor,l=e.textColor,a=this.width,u=this.height;this.state.scrollPos=t;var c=this.canvasContext,f="horizontal"===o;c.rect(0,0,2*a,2*u),c.fillStyle=r,c.fill(),c.save(),c.scale(2,2),c.strokeStyle=s,c.lineWidth=1,c.font="10px sans-serif",c.fillStyle=l,c.translate(.5,0),c.beginPath();for(var p=f?a:u,h=i*n,_=Math.floor(t*i/h),d=Math.ceil((t*i+p)/h)-_,v=0;v<d;++v){var g=((v+_)*n-t)*i;if(-h<=g&&g<p){var m=f?3+g:a-18,y=f?u-18:g-4;f?c.fillText(""+(v+_)*n,m,y):(c.save(),c.translate(m,y),c.rotate(-Math.PI/2),c.fillText(""+(v+_)*n,0,0),c.restore())}for(var b=0;b<10;++b){var C=g+b/10*h;if(!(C<0||p<=C)){var w=0===b?f?u:a:b%2==0?10:7,P=f?C:a-w,k=f?C:a,E=f?u-w:C,x=f?u:C;c.moveTo(P,E),c.lineTo(k,x)}}}c.stroke(),c.restore()},t.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,style:{width:"100%",height:"100%"},backgroundColor:"#333333",textColor:"#ffffff",lineColor:"#777777"},t}(q);function pt(t,e,n,i){t.addEventListener(e,n,i)}function ht(t,e,n){t.removeEventListener(e,n)}var _t=function(){return(_t=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function dt(t,e,n,i){var o=wt(t),r=wt(e),s=wt(i);return gt(Pt(i[0],kt(o,s)),Pt(i[0],kt(r,s)),n[0])}function vt(t){return t.touches?bt(t.touches):[Ct(t)]}function gt(t,e,n){var i=t.clientX,o=t.clientY;return{clientX:i,clientY:o,deltaX:i-e.clientX,deltaY:o-e.clientY,distX:i-n.clientX,distY:o-n.clientY}}function mt(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function yt(t,n,i){return t.map(function(t,e){return gt(t,n[e],i[e])})}function bt(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(Ct(t[i]));return n}function Ct(t){return{clientX:t.clientX,clientY:t.clientY}}function wt(t){return{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function Pt(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}}function kt(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}}var Et=function(){function t(t,e){var r=this;void 0===e&&(e={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.onDragStart=function(t){if(r.flag||!1!==t.cancelable){if(function(t){return t.touches&&2<=t.touches.length}(t)){if(!r.flag&&t.touches.length!==t.changedTouches.length)return;r.pinchFlag||r.onPinchStart(t)}if(!r.flag){var e=r.startClients[0]?r.startClients:vt(t);r.customDist=[0,0],r.flag=!0,r.isDrag=!1,r.startClients=e,r.prevClients=e,r.datas={};var n=gt(e[r.movement=0],r.prevClients[0],r.startClients[0]),i=r.options,o=i.dragstart;(i.preventRightClick&&3===t.which||!1===(o&&o(_t({datas:r.datas,inputEvent:t},n))))&&(r.startClients=[],r.prevClients=[],r.flag=!1),r.flag&&t.preventDefault()}}},this.onDrag=function(t,e){if(r.flag){var n=vt(t);r.pinchFlag&&r.onPinch(t,n);var i=r.move([0,0],t,n);if(i&&(i.deltaX||i.deltaY)){var o=r.options.drag;o&&o(_t({},i,{isScroll:!!e,inputEvent:t}))}}},this.onDragEnd=function(t){if(r.flag){r.pinchFlag&&r.onPinchEnd(t),r.flag=!1;var e=r.options.dragend,n=r.prevClients,i=r.startClients,o=r.pinchFlag?dt(n,n,i,r.startPinchClients):gt(n[0],n[0],i[0]);r.startClients=[],r.prevClients=[],e&&e(_t({datas:r.datas,isDrag:r.isDrag,inputEvent:t},o))}},this.options=_t({container:t,preventRightClick:!0,pinchThreshold:0,events:["touch","mouse"]},e);var n=this.options,i=n.container,o=n.events;if(this.isTouch=-1<o.indexOf("touch"),this.isMouse=-1<o.indexOf("mouse"),this.customDist=[0,0],this.isMouse&&(pt(t,"mousedown",this.onDragStart),pt(i,"mousemove",this.onDrag),pt(i,"mouseup",this.onDragEnd)),this.isTouch){var s={passive:!1};pt(t,"touchstart",this.onDragStart,s),pt(i,"touchmove",this.onDrag,s),pt(i,"touchend",this.onDragEnd,s)}}var e=t.prototype;return e.isDragging=function(){return this.isDrag},e.isPinching=function(){return this.isPinch},e.scrollBy=function(e,n,t,i){void 0===i&&(i=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),i&&this.onDrag(t,!0))},e.move=function(t,e,n){var i=t[0],o=t[1];void 0===n&&(n=this.prevClients);var r=this.customDist,s=this.prevClients,l=this.startClients,a=this.pinchFlag?dt(n,s,l,this.startPinchClients):gt(n[0],s[0],l[0]);r[0]+=i,r[1]+=o,a.deltaX+=i,a.deltaY+=o;var u=a.deltaX,c=a.deltaY;return a.distX+=r[0],a.distY+=r[1],this.movement+=Math.sqrt(u*u+c*c),this.prevClients=n,this.isDrag=!0,_t({datas:this.datas},a,{isScroll:!1,inputEvent:e})},e.onPinchStart=function(t){var e,n,i=this.options,o=i.pinchstart,r=i.pinchThreshold;if(!(this.isDrag&&this.movement>r)){var s=bt(t.changedTouches);if(this.pinchFlag=!0,(e=this.startClients).push.apply(e,s),(n=this.prevClients).push.apply(n,s),this.startDistance=mt(this.prevClients),this.startPinchClients=this.prevClients.slice(),o){var l=this.prevClients,a=wt(l),u=gt(a,a,a);o(_t({datas:this.datas,touches:yt(l,l,l)},u,{inputEvent:t}))}}},e.onPinch=function(t,e){if(this.flag&&this.pinchFlag){this.isPinch=!0;var n=this.options.pinch;if(n){var i=this.prevClients,o=this.startClients,r=gt(wt(e),wt(i),wt(o)),s=mt(e);n(_t({datas:this.datas,touches:yt(e,i,o),scale:s/this.startDistance,distance:s},r,{inputEvent:t}))}}},e.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var i=this.prevClients,o=this.startClients,r=gt(wt(i),wt(i),wt(o));n(_t({datas:this.datas,isPinch:e,touches:yt(i,i,o)},r,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},e.unset=function(){var t=this.el,e=this.options.container;this.isMouse&&(ht(t,"mousedown",this.onDragStart),ht(e,"mousemove",this.onDrag),ht(e,"mouseup",this.onDragEnd)),this.isTouch&&(ht(t,"touchstart",this.onDragStart),ht(e,"touchmove",this.onDrag),ht(e,"touchend",this.onDragEnd))},t}();var xt=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function Ot(n,t,e){var i=document.createElement("style");return i.setAttribute("type","text/css"),i.innerHTML=t.replace(/([^}{]*){/gm,function(t,e){return function(t){var e=t.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g);return e?e.map(function(t){return t.trim()}):[]}(e).map(function(t){return-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+n):"."+n+" "+t}).join(", ")+"{"}),(e||document.head||document.body).appendChild(i),i}function Dt(o){var r,s="rCS"+function(t){return xt(t).toString(36)}(o),l=0;return{className:s,inject:function(t){var e,n=function(t){if(t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),i=0===l;return(n||i)&&(e=Ot(s,o,n)),i&&(r=e),n||++l,{destroy:function(){n?(t.removeChild(e),e=null):(0<l&&--l,0===l&&r&&(r.parentNode.removeChild(r),r=null))}}}}}var St=function(t,e){return(St=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var Nt=function(){return(Nt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var jt=function(t,e){return(jt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function zt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(t){return t.split(" ").map(function(t){return t?""+e+t:""}).join(" ")}).join(" ")}.apply(void 0,["scena-"].concat(t))}zt("ruler");var Tt,Xt,Yt,Gt=zt("guide","adder"),Mt=zt("guides"),At=zt("guide"),Ft=zt("dragging"),Rt=(Tt="div",Xt='\n{\n    position: relative;\n}\ncanvas {\n    position: relative;\n}\n.guides {\n    position: absolute;\n    top: 0;\n    left: 0;\n    will-change: transform;\n    z-index: 2000;\n}\n:host.horizontal .guides {\n    width: 100%;\n    height: 0;\n    top: 30px;\n}\n:host.vertical .guides {\n    height: 100%;\n    width: 0;\n    left: 30px;\n}\n.guide {\n    position: absolute;\n    background: #f33;\n    z-index: 2;\n}\n.guide.dragging:before {\n    position: absolute;\n    content: "";\n    width: 100%;\n    height: 100%;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n:host.horizontal .guide {\n    width: 100%;\n    height: 1px;\n    cursor: row-resize;\n}\n:host.vertical .guide {\n    width: 1px;\n    height: 100%;\n    cursor: col-resize;\n}\n.mobile :host.horizontal .guide {\n    transform: scale(1, 2);\n}\n.mobile :host.vertical .guide {\n    transform: scale(2, 1);\n}\n:host.horizontal .guide:before {\n    height: 20px;\n}\n:host.vertical .guide:before {\n    width: 20px;\n}\n.adder {\n    display: none;\n}\n.adder.dragging {\n    display: block;\n}\n'.replace(/\.([^{,\s\d.]+)/g,"."+"scena-"+"$1"),Yt=Dt(Xt),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return function(t,e){function n(){this.constructor=t}St(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.render=function(){var t=this.props,e=t.className,n=void 0===e?"":e,i=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n}(t,["className"]);return h(Tt,Nt({ref:p(this,"element"),className:n+" "+Yt.className},i))},e.prototype.componentDidMount=function(){this.injectResult=Yt.inject(this.element)},e.prototype.componentWillUnmount=function(){this.injectResult.destroy(),this.injectResult=null},e.prototype.getElement=function(){return this.element},e}(E)),Lt=function(t){function e(){var u=null!==t&&t.apply(this,arguments)||this;return u.state={guides:[]},u.scrollPos=0,u.guideElements=[],u.onDragStart=function(t){var e=t.datas,n=t.clientX,i=t.clientY,o=t.inputEvent,r="horizontal"===u.props.type,s=u.guidesElement.getBoundingClientRect();e.offset=r?s.top:s.left,function(t,e){t.classList?t.classList.add(e):t.className+=" "+e}(e.target,Ft),u.onDrag({datas:e,clientX:n,clientY:i}),o.stopPropagation(),o.preventDefault()},u.onDrag=function(t){var e=t.datas,n=t.clientX,i=t.clientY,o="horizontal"===u.props.type,r=Math.round((o?i:n)-e.offset);return e.target.style.transform=u.getTranslateName()+"("+r+"px)",r},u.onDragEnd=function(t){var e=t.datas,n=t.clientX,i=t.clientY,o=u.onDrag({datas:e,clientX:n,clientY:i}),r=u.state.guides,s=u.props.setGuides,l=Math.round(o/u.props.zoom);if(!function(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}(e.target,Ft),e.fromRuler)o>=u.scrollPos&&r.indexOf(l)<0&&u.setState({guides:r.concat([l])},function(){s(u.state.guides)});else{var a=e.target.getAttribute("data-index");o<u.scrollPos||-1<r.indexOf(l)?r.splice(a,1):r[a]=l,u.setState({guides:r.slice()},function(){s(u.state.guides)})}},u}!function(t,e){function n(){this.constructor=t}jt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.className,n=t.type,i=t.width,o=t.height,r=t.unit,s=t.zoom,l=t.style,a=t.rulerStyle,u=t.backgroundColor,c=t.lineColor,f=t.textColor;return h(Rt,{ref:p(this,"manager"),className:zt("manager",n)+" "+e,style:l},h(ft,{ref:p(this,"ruler"),type:n,width:i,height:o,unit:r,zoom:s,backgroundColor:u,lineColor:c,style:a,textColor:f}),h("div",{className:Mt,ref:p(this,"guidesElement")},h("div",{className:Gt,ref:p(this,"adderElement")}),this.renderGuides()))},n.renderGuides=function(){var n=this,t=this.props,i=t.type,o=t.zoom,r="horizontal"===i?"translateY":"translateX",e=this.state.guides;return this.guideElements=[],e.map(function(t,e){return h("div",{className:zt("guide",i),ref:function(e,n,i){return function(t){t&&(e[n][i]=t)}}(n,"guideElements",e),key:e,"data-index":e,style:{transform:r+"("+t*o+"px)"}})})},n.componentDidMount=function(){var i=this;this.dragger=new Et(this.manager.getElement(),{container:document.body,dragstart:function(t){var e=t.inputEvent.target,n=t.datas;if(e===i.ruler.canvasElement)t.datas.fromRuler=!0,n.target=i.adderElement;else{if(!function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}(e,At))return!1;n.target=e}i.onDragStart(t)},drag:this.onDrag,dragend:this.onDragEnd})},n.componentWillUnmount=function(){this.dragger.unset()},n.getGuides=function(){return this.state.guides},n.scrollGuides=function(n){var t=this.props.zoom,e=this.guidesElement;this.scrollPos=n,e.style.transform=this.getTranslateName()+"("+-n*t+"px)";var i=this.state.guides;this.guideElements.forEach(function(t,e){t&&(t.style.display=-n+i[e]<0?"none":"block")})},n.resize=function(){this.ruler.resize()},n.scroll=function(t){this.ruler.scroll(t)},n.getTranslateName=function(){return"horizontal"===this.props.type?"translateY":"translateX"},e.defaultProps={className:"",type:"horizontal",setGuides:function(){},zoom:1,style:{width:"100%",height:"100%"}},e}(q),Ut=function(n){function t(t){var e=n.call(this,t)||this;return e.state={},e.state=e.props,e}return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,n),t.prototype.render=function(){var t=this.state,e=t.container,n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n}(t,["container"]);return function(t,e){return h(it,{vnode:t,container:e})}(h(Lt,o({ref:p(this,"preactGuides")},n)),e)},t}(E),Wt=function(){function t(t,e){void 0===e&&(e={}),this.tempElement=document.createElement("div"),g(h(Ut,o({ref:p(this,"innerGuides")},e,{container:t})),this.tempElement)}var e=t.prototype;return e.scroll=function(t){this.getPreactGuides().scroll(t)},e.scrollGuides=function(t){this.getPreactGuides().scrollGuides(t)},e.resize=function(){this.getPreactGuides().resize()},e.getGuides=function(){return this.getPreactGuides().getGuides()},e.setState=function(t,e){this.innerGuides.setState(t,e)},e.destroy=function(){g("",this.tempElement),this.tempElement=null,this.innerGuides=null},e.getPreactGuides=function(){return this.innerGuides.preactGuides},t=function(t,e,n,i){var o,r=arguments.length,s=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;0<=l;l--)(o=t[l])&&(s=(r<3?o(s):3<r?o(e,n,s):o(e,n))||s);return 3<r&&s&&Object.defineProperty(e,n,s),s}([function(n,i){return function(t){var e=t.prototype;n.forEach(function(t){i(e,t)})}}(Y,function(t,n){Object.defineProperty(t,n,{get:function(){return this.getPreactGuides().props[n]},set:function(t){var e;this.innerGuides.setState(((e={})[n]=t,e))},enumerable:!0,configurable:!0})})],t)}();return Wt.PROPERTIES=Y,Wt});
//# sourceMappingURL=guides.min.js.map
