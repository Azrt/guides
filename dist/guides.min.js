/*
Copyright (c) 2019 Daybrush
name: @scena/guides
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/guides.git
version: 0.2.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Guides=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function c(e,n){return function(t){t&&(e[n]=t)}}var b,l,e,n,s,C={},k=[],o=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i;function w(t,e){for(var n in e)t[n]=e[n];return t}function m(t){var e=t.parentNode;e&&e.removeChild(t)}function a(t,e,n){var i,r,o,s,l=arguments;if(e=w({},e),3<arguments.length)for(n=[n],i=3;i<arguments.length;i++)n.push(l[i]);if(null!=n&&(e.children=n),null!=t&&null!=t.defaultProps)for(r in t.defaultProps)void 0===e[r]&&(e[r]=t.defaultProps[r]);return s=e.key,null!=(o=e.ref)&&delete e.ref,null!=s&&delete e.key,u(t,e,s,o)}function u(t,e,n,i){var r={type:t,props:e,key:n,ref:i,__k:null,__p:null,__b:0,__e:null,__d:null,__c:null,constructor:void 0};return b.vnode&&b.vnode(r),r}function P(t){return t.children}function E(t,e){this.props=t,this.context=e}function y(t,e){if(null==e)return t.__p?y(t.__p,t.__p.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e)return n.__e;return"function"==typeof t.type?y(t):null}function p(t){var e,n;if(null!=(t=t.__p)&&null!=t.__c){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if(null!=(n=t.__k[e])&&null!=n.__e){t.__e=t.__c.base=n.__e;break}return p(t)}}function f(t){(!t.__d&&(t.__d=!0)&&1===l.push(t)||n!==b.debounceRendering)&&(n=b.debounceRendering,(b.debounceRendering||e)(h))}function h(){var t,e,n,i,r,o,s;for(l.sort(function(t,e){return e.__v.__b-t.__v.__b});t=l.pop();)t.__d&&(i=n=void 0,o=(r=(e=t).__v).__e,(s=e.__P)&&(n=[],i=S(s,r,w({},r),e.__n,void 0!==s.ownerSVGElement,null,n,null==o?y(r):o),v(n,r),i!=o&&p(r)))}function x(e,n,t,i,r,o,s,l,a){var u,c,p,f,h,_,d,v=t&&t.__k||k,g=v.length;if(l==C&&(l=null!=o?o[0]:g?y(t,0):null),u=0,n.__k=O(n.__k,function(t){if(null!=t){if(t.__p=n,t.__b=n.__b+1,null===(p=v[u])||p&&t.key==p.key&&t.type===p.type)v[u]=void 0;else for(c=0;c<g;c++){if((p=v[c])&&t.key==p.key&&t.type===p.type){v[c]=void 0;break}p=null}if(f=S(e,t,p=p||C,i,r,o,s,l,a),(c=t.ref)&&p.ref!=c&&(d=d||[]).push(c,t.__c||f,t),null!=f){if(null==_&&(_=f),null!=t.__d)f=t.__d,t.__d=null;else if(o==p||f!=l||null==f.parentNode){t:if(null==l||l.parentNode!==e)e.appendChild(f);else{for(h=l,c=0;(h=h.nextSibling)&&c<g;c+=2)if(h==f)break t;e.insertBefore(f,l)}"option"==n.type&&(e.value="")}l=f.nextSibling,"function"==typeof n.type&&(n.__d=f)}}return u++,t}),n.__e=_,null!=o&&"function"!=typeof n.type)for(u=o.length;u--;)null!=o[u]&&m(o[u]);for(u=g;u--;)null!=v[u]&&j(v[u],v[u]);if(d)for(u=0;u<d.length;u++)N(d[u],d[++u],d[++u])}function O(t,e,n){if(null==n&&(n=[]),null==t||"boolean"==typeof t)e&&n.push(e(null));else if(Array.isArray(t))for(var i=0;i<t.length;i++)O(t[i],e,n);else n.push(e?e("string"==typeof t||"number"==typeof t?u(null,t,null,null):null!=t.__e||null!=t.__c?u(t.type,t.props,t.key,null):t):t);return n}function _(t,e,n){"-"===e[0]?t.setProperty(e,n):t[e]="number"==typeof n&&!1===o.test(e)?n+"px":null==n?"":n}function D(t,e,n,i,r){var o,s,l,a,u;if("key"!==(e=r?"className"===e?"class":e:"class"===e?"className":e)&&"children"!==e)if("style"===e)if(o=t.style,"string"==typeof n)o.cssText=n;else{if("string"==typeof i&&(o.cssText="",i=null),i)for(s in i)n&&s in n||_(o,s,"");if(n)for(l in n)i&&n[l]===i[l]||_(o,l,n[l])}else"o"===e[0]&&"n"===e[1]?(a=e!==(e=e.replace(/Capture$/,"")),e=((u=e.toLowerCase())in t?u:e).slice(2),n?(i||t.addEventListener(e,d,a),(t.l||(t.l={}))[e]=n):t.removeEventListener(e,d,a)):"list"!==e&&"tagName"!==e&&"form"!==e&&!r&&e in t?t[e]=null==n?"":n:"function"!=typeof n&&"dangerouslySetInnerHTML"!==e&&(e!==(e=e.replace(/^xlink:?/,""))?null==n||!1===n?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),n):null==n||!1===n?t.removeAttribute(e):t.setAttribute(e,n))}function d(t){this.l[t.type](b.event?b.event(t):t)}function S(t,e,n,i,r,o,s,l,a){var u,c,p,f,h,_,d,v,g,m,y=e.type;if(void 0!==e.constructor)return null;(u=b.__b)&&u(e);try{t:if("function"==typeof y){if(v=e.props,g=(u=y.contextType)&&i[u.__c],m=u?g?g.props.value:u.__p:i,n.__c?d=(c=e.__c=n.__c).__p=c.__E:("prototype"in y&&y.prototype.render?e.__c=c=new y(v,m):(e.__c=c=new E(v,m),c.constructor=y,c.render=z),g&&g.sub(c),c.props=v,c.state||(c.state={}),c.context=m,c.__n=i,p=c.__d=!0,c.__h=[]),null==c.__s&&(c.__s=c.state),null!=y.getDerivedStateFromProps&&w(c.__s==c.state?c.__s=w({},c.__s):c.__s,y.getDerivedStateFromProps(v,c.__s)),f=c.props,h=c.state,p)null==y.getDerivedStateFromProps&&null!=c.componentWillMount&&c.componentWillMount(),null!=c.componentDidMount&&c.__h.push(c.componentDidMount);else{if(null==y.getDerivedStateFromProps&&null==c.__e&&null!=c.componentWillReceiveProps&&c.componentWillReceiveProps(v,m),!c.__e&&null!=c.shouldComponentUpdate&&!1===c.shouldComponentUpdate(v,c.__s,m)){for(c.props=v,c.state=c.__s,c.__d=!1,(c.__v=e).__e=n.__e,e.__k=n.__k,u=0;u<e.__k.length;u++)e.__k[u]&&(e.__k[u].__p=e);break t}null!=c.componentWillUpdate&&c.componentWillUpdate(v,c.__s,m),null!=c.componentDidUpdate&&c.__h.push(function(){c.componentDidUpdate(f,h,_)})}c.context=m,c.props=v,c.state=c.__s,(u=b.__r)&&u(e),c.__d=!1,c.__v=e,c.__P=t,u=c.render(c.props,c.state,c.context),e.__k=O(null!=u&&u.type==P&&null==u.key?u.props.children:u),null!=c.getChildContext&&(i=w(w({},i),c.getChildContext())),p||null==c.getSnapshotBeforeUpdate||(_=c.getSnapshotBeforeUpdate(f,h)),x(t,e,n,i,r,o,s,l,a),c.base=e.__e,c.__h.length&&s.push(c),d&&(c.__E=c.__p=null),c.__e=null}else e.__e=function(t,e,n,i,r,o,s,l){var a,u,c,p,f,h=n.props,_=e.props;if(r="svg"===e.type||r,null==t&&null!=o)for(a=0;a<o.length;a++)if(null!=(u=o[a])&&(null===e.type?3===u.nodeType:u.localName===e.type)){t=u,o[a]=null;break}if(null==t){if(null===e.type)return document.createTextNode(_);t=r?document.createElementNS("http://www.w3.org/2000/svg",e.type):document.createElement(e.type),o=null}if(null===e.type)null!=o&&(o[o.indexOf(t)]=null),h!==_&&(t.data=_);else if(e!==n){if(null!=o&&(o=k.slice.call(t.childNodes)),c=(h=n.props||C).dangerouslySetInnerHTML,p=_.dangerouslySetInnerHTML,!l){if(h===C)for(h={},f=0;f<t.attributes.length;f++)h[t.attributes[f].name]=t.attributes[f].value;(p||c)&&(p&&c&&p.__html==c.__html||(t.innerHTML=p&&p.__html||""))}(function(t,e,n,i,r){var o;for(o in n)o in e||D(t,o,null,n[o],i);for(o in e)r&&"function"!=typeof e[o]||"value"===o||"checked"===o||n[o]===e[o]||D(t,o,e[o],n[o],i)})(t,_,h,r,l),e.__k=e.props.children,p||x(t,e,n,i,"foreignObject"!==e.type&&r,o,s,C,l),l||("value"in _&&void 0!==_.value&&_.value!==t.value&&(t.value=null==_.value?"":_.value),"checked"in _&&void 0!==_.checked&&_.checked!==t.checked&&(t.checked=_.checked))}return t}(n.__e,e,n,i,r,o,s,a);(u=b.diffed)&&u(e)}catch(t){b.__e(t,e,n)}return e.__e}function v(t,e){b.__c&&b.__c(e,t),t.some(function(e){try{t=e.__h,e.__h=[],t.some(function(t){t.call(e)})}catch(t){b.__e(t,e.__v)}})}function N(t,e,n){try{"function"==typeof t?t(e):t.current=e}catch(t){b.__e(t,n)}}function j(t,e,n){var i,r,o;if(b.unmount&&b.unmount(t),(i=t.ref)&&N(i,null,e),n||"function"==typeof t.type||(n=null!=(r=t.__e)),t.__e=t.__d=null,null!=(i=t.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(t){b.__e(t,e)}i.base=i.__P=null}if(i=t.__k)for(o=0;o<i.length;o++)i[o]&&j(i[o],e,n);null!=r&&m(r)}function z(t,e,n){return this.constructor(t,n)}function g(t,e,n){var i,r,o;b.__p&&b.__p(t,e),r=(i=n===s)?null:n&&n.__k||e.__k,t=a(P,null,[t]),o=[],S(e,(i?e:n||e).__k=t,r||C,C,void 0!==e.ownerSVGElement,n&&!i?[n]:r?null:k.slice.call(e.childNodes),o,n||C,i),v(o,t)}b={},E.prototype.setState=function(t,e){var n=this.__s!==this.state&&this.__s||(this.__s=w({},this.state));"function"==typeof t&&!(t=t(n,this.props))||w(n,t),null!=t&&this.__v&&(this.__e=!1,e&&this.__h.push(e),f(this))},E.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),f(this))},E.prototype.render=P,l=[],e="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,n=b.debounceRendering,b.__e=function(t,e,n){for(var i;e=e.__p;)if((i=e.__c)&&!i.__p)try{if(i.constructor&&null!=i.constructor.getDerivedStateFromError)i.setState(i.constructor.getDerivedStateFromError(t));else{if(null==i.componentDidCatch)continue;i.componentDidCatch(t)}return f(i.__E=i)}catch(e){t=e}throw t},s=C;var T,X=["setGuides","type","width","height","rulerStyle","unit","zoom","style","backgroundColor","lineColor"],Y=[],G=b.__r;b.__r=function(t){G&&G(t),(T=t.__c).__H&&(T.__H.t.forEach(W),T.__H.t.forEach(H),T.__H.t=[])};var M=b.diffed;b.diffed=function(t){M&&M(t);var e=t.__c;if(e){var n=e.__H;n&&n.t.length&&L(Y.push(e))}};var A=b.__c;b.__c=function(t,e){e.some(function(t){t.__h.forEach(W),t.__h=t.__h.filter(function(t){return!t.u||H(t)})}),A&&A(t,e)};var F=b.unmount;b.unmount=function(t){F&&F(t);var e=t.__c;if(e){var n=e.__H;n&&n.i.forEach(function(t){return t.m&&t.m()})}};var L=function(){};function R(){Y.some(function(t){t.__P&&(t.__H.t.forEach(W),t.__H.t.forEach(H),t.__H.t=[])}),Y=[]}if("undefined"!=typeof window){var U=b.requestAnimationFrame;L=function(t){1!==t&&U===b.requestAnimationFrame||((U=b.requestAnimationFrame)||function(t){function e(){clearTimeout(n),cancelAnimationFrame(i),setTimeout(t)}var n=setTimeout(e,100),i=requestAnimationFrame(e)})(R)}}function W(t){t.m&&t.m()}function H(t){var e=t.u();"function"==typeof e&&(t.m=e)}var $=b.__e;b.__e=function(t,e,n){if(t.then&&n)for(var i,r=e;r=r.__p;)if((i=r.__c)&&i.o)return n&&(e.__e=n.__e,e.__k=n.__k),void i.o(t);$(t,e,n)},(new E).o=function(t){var e=this;e.__u.push(t);function n(){e.__u[e.__u.indexOf(t)]=e.__u[e.__u.length-1],e.__u.pop(),0==e.__u.length&&(e.__f&&j(e.__f),e.__v.__e=null,e.__v.__k=e.state.u,e.setState({u:null}))}null==e.state.u&&(e.__f=e.__f&&function(t,e){return e=w(w({},t.props),e),2<arguments.length&&(e.children=k.slice.call(arguments,2)),u(t.type,e,e.key||t.key,e.ref||t.ref)}(e.__f),e.setState({u:e.__v.__k}),function t(e){for(var n=0;n<e.length;n++){var i=e[n];null!=i&&("function"!=typeof i.type&&i.__e?(r=i.__e,o=void 0,(o=r.parentNode)&&o.removeChild(r)):i.__k&&t(i.__k))}var r,o}(e.__v.__k),e.__v.__k=[]),t.then(n,n)};var I="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,q=/^(?:accent|alignment|arabic|baseline|cap|clip|color|fill|flood|font|glyph|horiz|marker|overline|paint|stop|strikethrough|stroke|text|underline|unicode|units|v|vector|vert|word|writing|x)[A-Z]/,B=b.event;b.event=function(t){return B&&(t=B(t)),t.persist=function(){},t.nativeEvent=t};var V=function(){};function Z(t){var e=this,n=t.container,i=a(V,{context:e.context},t.vnode);return e.i&&e.i!==n&&(e.l.parentNode&&e.i.removeChild(e.l),j(e.s),e.v=!1),t.vnode?e.v?(n.__k=e.__k,g(i,n),e.__k=n.__k):(e.l=document.createTextNode(""),function(t,e){g(t,e,s)}("",n),n.appendChild(e.l),e.v=!0,g(i,e.i=n,e.l),e.__k=this.l.__k):e.v&&(e.l.parentNode&&e.i.removeChild(e.l),j(e.s)),e.s=i,e.componentWillUnmount=function(){e.l.parentNode&&e.i.removeChild(e.l),j(e.s)},null}function J(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];var n=a.apply(void 0,t),i=n.type,r=n.props;return"function"!=typeof i&&(r.defaultValue&&(r.value||0===r.value||(r.value=r.defaultValue),delete r.defaultValue),Array.isArray(r.value)&&r.multiple&&"select"===i&&(O(r.children).forEach(function(t){-1!=r.value.indexOf(t.props.value)&&(t.props.selected=!0)}),delete r.value),function(t,e){var n,i,r;for(r in e)if(n=q.test(r))break;if(n)for(r in i=t.props={},e)i[q.test(r)?r.replace(/([A-Z0-9])/,"-$1").toLowerCase():r]=e[r]}(n,r)),n.preactCompatNormalized=!1,function(e){return e.preactCompatNormalized=!0,function(){var t=e.props;(t.class||t.className)&&(K.enumerable="className"in t,t.className&&(t.class=t.className),Object.defineProperty(t,"className",K))}(),e}(n)}V.prototype.getChildContext=function(){return this.props.context},V.prototype.render=function(t){return t.children};var K={configurable:!0,get:function(){return this.class}};function Q(t,e){for(var n in t)if("__source"!==n&&!(n in e))return!0;for(var i in e)if("__source"!==i&&t[i]!==e[i])return!0;return!1}var tt,t=((tt=E)&&(et.__proto__=tt),((et.prototype=Object.create(tt&&tt.prototype)).constructor=et).prototype.shouldComponentUpdate=function(t,e){return Q(this.props,t)||Q(this.state,e)},et);function et(t){tt.call(this,t),this.isPureReactComponent=!0}function nt(t,e){t["UNSAFE_"+e]&&!t[e]&&Object.defineProperty(t,e,{configurable:!1,get:function(){return this["UNSAFE_"+e]},set:function(t){this["UNSAFE_"+e]=t}})}E.prototype.isReactComponent={};var it=b.vnode;function rt(t,e,n,i){t.addEventListener(e,n,i)}function ot(t,e,n){t.removeEventListener(e,n)}b.vnode=function(o){o.$$typeof=I,function(){var t=o.type,e=o.props;if(e&&"string"==typeof t){var n={};for(var i in e)/^on(Ani|Tra)/.test(i)&&(e[i.toLowerCase()]=e[i],delete e[i]),n[i.toLowerCase()]=i;if(n.ondoubleclick&&(e.ondblclick=e[n.ondoubleclick],delete e[n.ondoubleclick]),n.onbeforeinput&&(e.onbeforeinput=e[n.onbeforeinput],delete e[n.onbeforeinput]),n.onchange&&("textarea"===t||"input"===t.toLowerCase()&&!/^fil|che|ra/i.test(e.type))){var r=n.oninput||"oninput";e[r]||(e[r]=e[n.onchange],delete e[n.onchange])}}}();var t=o.type;t&&t.t&&o.ref&&(o.props.ref=o.ref,o.ref=null),"function"==typeof t&&!t.p&&t.prototype&&(nt(t.prototype,"componentWillMount"),nt(t.prototype,"componentWillReceiveProps"),nt(t.prototype,"componentWillUpdate"),t.p=!0),it&&it(o)};var st=function(){return(st=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function lt(t,e,n,i){var r=_t(t),o=_t(e),s=_t(i);return ut(dt(i[0],vt(r,s)),dt(i[0],vt(o,s)),n[0])}function at(t){return t.touches?ft(t.touches):[ht(t)]}function ut(t,e,n){var i=t.clientX,r=t.clientY;return{clientX:i,clientY:r,deltaX:i-e.clientX,deltaY:r-e.clientY,distX:i-n.clientX,distY:r-n.clientY}}function ct(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function pt(t,n,i){return t.map(function(t,e){return ut(t,n[e],i[e])})}function ft(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(ht(t[i]));return n}function ht(t){return{clientX:t.clientX,clientY:t.clientY}}function _t(t){return{clientX:(t[0].clientX+t[1].clientX)/2,clientY:(t[0].clientY+t[1].clientY)/2}}function dt(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}}function vt(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}}var gt=function(){function t(t,e){var o=this;void 0===e&&(e={}),this.el=t,this.options={},this.flag=!1,this.pinchFlag=!1,this.datas={},this.isDrag=!1,this.isPinch=!1,this.isMouse=!1,this.isTouch=!1,this.prevClients=[],this.startClients=[],this.movement=0,this.startPinchClients=[],this.startDistance=0,this.customDist=[0,0],this.onDragStart=function(t){if(o.flag||!1!==t.cancelable){if(function(t){return t.touches&&2<=t.touches.length}(t)){if(!o.flag&&t.touches.length!==t.changedTouches.length)return;o.pinchFlag||o.onPinchStart(t)}if(!o.flag){var e=o.startClients[0]?o.startClients:at(t);o.customDist=[0,0],o.flag=!0,o.isDrag=!1,o.startClients=e,o.prevClients=e,o.datas={};var n=ut(e[o.movement=0],o.prevClients[0],o.startClients[0]),i=o.options,r=i.dragstart;(i.preventRightClick&&3===t.which||!1===(r&&r(st({datas:o.datas,inputEvent:t},n))))&&(o.startClients=[],o.prevClients=[],o.flag=!1),o.flag&&t.preventDefault()}}},this.onDrag=function(t,e){if(o.flag){var n=at(t);o.pinchFlag&&o.onPinch(t,n);var i=o.move([0,0],t,n);if(i&&(i.deltaX||i.deltaY)){var r=o.options.drag;r&&r(st({},i,{isScroll:!!e,inputEvent:t}))}}},this.onDragEnd=function(t){if(o.flag){o.pinchFlag&&o.onPinchEnd(t),o.flag=!1;var e=o.options.dragend,n=o.prevClients,i=o.startClients,r=o.pinchFlag?lt(n,n,i,o.startPinchClients):ut(n[0],n[0],i[0]);o.startClients=[],o.prevClients=[],e&&e(st({datas:o.datas,isDrag:o.isDrag,inputEvent:t},r))}},this.options=st({container:t,preventRightClick:!0,pinchThreshold:0,events:["touch","mouse"]},e);var n=this.options,i=n.container,r=n.events;this.isTouch=-1<r.indexOf("touch"),this.isMouse=-1<r.indexOf("mouse"),this.customDist=[0,0],this.isMouse&&(rt(t,"mousedown",this.onDragStart),rt(i,"mousemove",this.onDrag),rt(i,"mouseup",this.onDragEnd)),this.isTouch&&(rt(t,"touchstart",this.onDragStart),rt(i,"touchmove",this.onDrag),rt(i,"touchend",this.onDragEnd))}var e=t.prototype;return e.isDragging=function(){return this.isDrag},e.isPinching=function(){return this.isPinch},e.scrollBy=function(e,n,t,i){void 0===i&&(i=!0),this.flag&&(this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),i&&this.onDrag(t,!0))},e.move=function(t,e,n){var i=t[0],r=t[1];void 0===n&&(n=this.prevClients);var o=this.customDist,s=this.prevClients,l=this.startClients,a=this.pinchFlag?lt(n,s,l,this.startPinchClients):ut(n[0],s[0],l[0]);o[0]+=i,o[1]+=r,a.deltaX+=i,a.deltaY+=r;var u=a.deltaX,c=a.deltaY;return a.distX+=o[0],a.distY+=o[1],this.movement+=Math.sqrt(u*u+c*c),this.prevClients=n,this.isDrag=!0,st({datas:this.datas},a,{isScroll:!1,inputEvent:e})},e.onPinchStart=function(t){var e,n,i=this.options,r=i.pinchstart,o=i.pinchThreshold;if(!(this.isDrag&&this.movement>o)){var s=ft(t.changedTouches);if(this.pinchFlag=!0,(e=this.startClients).push.apply(e,s),(n=this.prevClients).push.apply(n,s),this.startDistance=ct(this.prevClients),this.startPinchClients=this.prevClients.slice(),r){var l=this.prevClients,a=_t(l),u=ut(a,a,a);r(st({datas:this.datas,touches:pt(l,l,l)},u,{inputEvent:t}))}}},e.onPinch=function(t,e){if(this.flag&&this.pinchFlag){this.isPinch=!0;var n=this.options.pinch;if(n){var i=this.prevClients,r=this.startClients,o=ut(_t(e),_t(i),_t(r)),s=ct(e);n(st({datas:this.datas,touches:pt(e,i,r),scale:s/this.startDistance,distance:s},o,{inputEvent:t}))}}},e.onPinchEnd=function(t){if(this.flag&&this.pinchFlag){var e=this.isPinch;this.isPinch=!1,this.pinchFlag=!1;var n=this.options.pinchend;if(n){var i=this.prevClients,r=this.startClients,o=ut(_t(i),_t(i),_t(r));n(st({datas:this.datas,isPinch:e,touches:pt(i,i,r)},o,{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1}}},e.unset=function(){var t=this.el,e=this.options.container;this.isMouse&&(ot(t,"mousedown",this.onDragStart),ot(e,"mousemove",this.onDrag),ot(e,"mouseup",this.onDragEnd)),this.isTouch&&(ot(t,"touchstart",this.onDragStart),ot(e,"touchmove",this.onDrag),ot(e,"touchend",this.onDragEnd))},t}();var mt=function(t,e){return(mt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var yt=function(){return(yt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};var bt=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function Ct(n,t){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t.replace(/([^}{]*){/gm,function(t,e){return function(t){var e=t.match(/("[^"]*"|'[^']*'|[^,\s()]*\((?:[^()]*|\([^()]*\))*\)[^,\s()]*|[^,])+/g);return e?e.map(function(t){return t.trim()}):[]}(e).map(function(t){return-1<t.indexOf(":global")?t.replace(/\:global/g,""):-1<t.indexOf(":host")?""+t.replace(/\:host/g,"."+n):"."+n+" "+t}).join(", ")+"{"}),(document.head||document.body).appendChild(e),e}var kt=function(t,e){return(kt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var wt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scrollPos:0},t.width=0,t.height=0,t}!function(t,e){function n(){this.constructor=t}kt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e);var n=t.prototype;return n.render=function(){return J("canvas",{ref:c(this,"canvasElement"),style:this.props.style})},n.componentDidMount=function(){var t=this.canvasElement.getContext("2d");this.canvasContext=t,this.resize()},n.componentDidUpdate=function(){this.resize()},n.scroll=function(t){this.draw(t)},n.resize=function(){var t=this.canvasElement,e=this.props,n=e.width,i=e.height;this.width=n||t.offsetWidth,this.height=i||t.offsetHeight,t.width=2*this.width,t.height=2*this.height,this.draw()},n.draw=function(t){void 0===t&&(t=this.state.scrollPos);var e=this.props,n=e.unit,i=e.zoom,r=e.type,o=e.backgroundColor,s=e.lineColor,l=this.width,a=this.height;this.state.scrollPos=t;var u=this.canvasContext,c="horizontal"===r;u.rect(0,0,2*l,2*a),u.fillStyle=o,u.fill(),u.save(),u.scale(2,2),u.strokeStyle=s,u.lineWidth=1,u.font="10px sans-serif",u.fillStyle="#ffffff",u.translate(.5,0),u.beginPath();for(var p=c?l:a,f=i*n,h=Math.floor(t*i/f),_=Math.ceil((t*i+p)/f)-h,d=0;d<_;++d){var v=((d+h)*n-t)*i;if(-f<=v&&v<p){var g=c?3+v:l-18,m=c?a-18:v-4;c?u.fillText(""+(d+h)*n,g,m):(u.save(),u.translate(g,m),u.rotate(-Math.PI/2),u.fillText(""+(d+h)*n,0,0),u.restore())}for(var y=0;y<10;++y){var b=v+y/10*f;if(!(b<0||p<=b)){var C=0===y?c?a:l:y%2==0?10:7,k=c?b:l-C,w=c?b:l,P=c?a-C:b,E=c?a:b;u.moveTo(k,P),u.lineTo(w,E)}}}u.stroke(),u.restore()},t.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,style:{width:"100%",height:"100%"},backgroundColor:"#333333",lineColor:"#777777"},t}(t),Pt=function(t,e){return(Pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function Et(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.map(function(t){return t.split(" ").map(function(t){return t?""+e+t:""}).join(" ")}).join(" ")}.apply(void 0,["scena-"].concat(t))}Et("ruler");var xt,Ot,Dt,St,Nt,jt=Et("guide","adder"),zt=Et("guides"),Tt=Et("guide"),Xt=Et("dragging"),Yt=(xt="div",Ot='\n{\n    position: relative;\n}\ncanvas {\n    position: relative;\n}\n.guides {\n    position: absolute;\n    top: 0;\n    left: 0;\n    will-change: transform;\n    z-index: 2000;\n}\n:host.horizontal .guides {\n    width: 100%;\n    height: 0;\n    top: 30px;\n}\n:host.vertical .guides {\n    height: 100%;\n    width: 0;\n    left: 30px;\n}\n.guide {\n    position: absolute;\n    background: #f33;\n    z-index: 2;\n}\n.guide.dragging:before {\n    position: absolute;\n    content: "";\n    width: 100%;\n    height: 100%;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n:host.horizontal .guide {\n    width: 100%;\n    height: 1px;\n    cursor: row-resize;\n}\n:host.vertical .guide {\n    width: 1px;\n    height: 100%;\n    cursor: col-resize;\n}\n.mobile :host.horizontal .guide {\n    transform: scale(1, 2);\n}\n.mobile :host.vertical .guide {\n    transform: scale(2, 1);\n}\n:host.horizontal .guide:before {\n    height: 20px;\n}\n:host.vertical .guide:before {\n    width: 20px;\n}\n.adder {\n    display: none;\n}\n.adder.dragging {\n    display: block;\n}\n'.replace(/\.([^{,\s\d.]+)/g,"."+"scena-"+"$1"),St="rCS"+function(t){return bt(t).toString(36)}(Ot),Nt=0,function(e){function t(t){return e.call(this,t)||this}return function(t,e){function n(){this.constructor=t}mt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,e),t.prototype.render=function(){var t=this.props,e=t.className,n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["className"]);return J(xt,yt({className:e+" "+St},n))},t.prototype.componentDidMount=function(){0===Nt&&(Dt=Ct(St,Ot)),++Nt},t.prototype.componentWillUnmount=function(){0==--Nt&&Dt&&Dt.parentNode.removeChild(Dt)},t.prototype.getElement=function(){return this.element||(this.element=function(t){return t&&(t.base||1===t.nodeType&&t)||null}(this))},t}(E)),Gt=function(t){function e(){var u=null!==t&&t.apply(this,arguments)||this;return u.state={guides:[]},u.scrollPos=0,u.guideElements=[],u.onDragStart=function(t){var e=t.datas,n=t.clientX,i=t.clientY,r=t.inputEvent,o="horizontal"===u.props.type,s=u.guidesElement.getBoundingClientRect();e.offset=o?s.top:s.left,function(t,e){t.classList?t.classList.add(e):t.className+=" "+e}(e.target,Xt),u.onDrag({datas:e,clientX:n,clientY:i}),r.stopPropagation(),r.preventDefault()},u.onDrag=function(t){var e=t.datas,n=t.clientX,i=t.clientY,r="horizontal"===u.props.type,o=Math.round((r?i:n)-e.offset);return e.target.style.transform=u.getTranslateName()+"("+o+"px)",o},u.onDragEnd=function(t){var e=t.datas,n=t.clientX,i=t.clientY,r=u.onDrag({datas:e,clientX:n,clientY:i}),o=u.state.guides,s=u.props.setGuides,l=Math.round(r/u.props.zoom);if(!function(t,e){if(t.classList)t.classList.remove(e);else{var n=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(n," ")}}(e.target,Xt),e.fromRuler)r>=u.scrollPos&&o.indexOf(l)<0&&u.setState({guides:o.concat([l])},function(){s(u.state.guides)});else{var a=e.target.getAttribute("data-index");r<u.scrollPos||-1<o.indexOf(l)?o.splice(a,1):o[a]=l,u.setState({guides:o.slice()},function(){s(u.state.guides)})}},u}!function(t,e){function n(){this.constructor=t}Pt(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t);var n=e.prototype;return n.render=function(){var t=this.props,e=t.type,n=t.width,i=t.height,r=t.unit,o=t.zoom,s=t.style,l=t.rulerStyle,a=t.backgroundColor,u=t.lineColor;return J(Yt,{ref:c(this,"manager"),className:Et("manager",e),style:s},J(wt,{ref:c(this,"ruler"),type:e,width:n,height:i,unit:r,zoom:o,backgroundColor:a,lineColor:u,style:l}),J("div",{className:zt,ref:c(this,"guidesElement")},J("div",{className:jt,ref:c(this,"adderElement")}),this.renderGuides()))},n.renderGuides=function(){var n=this,t=this.props,i=t.type,r=t.zoom,o="horizontal"===i?"translateY":"translateX",e=this.state.guides;return this.guideElements=[],e.map(function(t,e){return J("div",{className:Et("guide",i),ref:function(e,n,i){return function(t){t&&(e[n][i]=t)}}(n,"guideElements",e),key:e,"data-index":e,style:{transform:o+"("+t*r+"px)"}})})},n.componentDidMount=function(){var i=this;this.dragger=new gt(this.manager.getElement(),{container:document.body,dragstart:function(t){var e=t.inputEvent.target,n=t.datas;if(e===i.ruler.canvasElement)t.datas.fromRuler=!0,n.target=i.adderElement;else{if(!function(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}(e,Tt))return!1;n.target=e}i.onDragStart(t)},drag:this.onDrag,dragend:this.onDragEnd})},n.componentWillUnmount=function(){this.dragger.unset()},n.getGuides=function(){return this.state.guides},n.scrollGuides=function(n){var t=this.props.zoom,e=this.guidesElement;this.scrollPos=n,e.style.transform=this.getTranslateName()+"("+-n*t+"px)";var i=this.state.guides;this.guideElements.forEach(function(t,e){t&&(t.style.display=-n+i[e]<0?"none":"block")})},n.resize=function(){this.ruler.resize()},n.scroll=function(t){this.ruler.scroll(t)},n.getTranslateName=function(){return"horizontal"===this.props.type?"translateY":"translateX"},e.defaultProps={setGuides:function(){},zoom:1,style:{width:"100%",height:"100%"}},e}(t),Mt=function(n){function t(t){var e=n.call(this,t)||this;return e.state={},e.state=e.props,e}return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(t,n),t.prototype.render=function(){var t=this.state,e=t.parentElement,n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(t,["parentElement"]);return function(t,e){return a(Z,{vnode:t,container:e})}(a(Gt,r({ref:c(this,"preactGuides")},n)),e)},t}(E),At=function(){function t(t,e){void 0===e&&(e={}),this.tempElement=document.createElement("div"),g(a(Mt,r({ref:c(this,"innerGuides")},e,{parentElement:t})),this.tempElement)}var e=t.prototype;return e.scroll=function(t){this.getPreactGuides().scroll(t)},e.scrollGuides=function(t){this.getPreactGuides().scrollGuides(t)},e.resize=function(){this.getPreactGuides().resize()},e.getGuides=function(){return this.getPreactGuides().getGuides()},e.setState=function(t,e){this.innerGuides.setState(t,e)},e.destroy=function(){g("",this.tempElement),this.tempElement=null,this.innerGuides=null},e.getPreactGuides=function(){return this.innerGuides.preactGuides},t=function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;0<=l;l--)(r=t[l])&&(s=(o<3?r(s):3<o?r(e,n,s):r(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([function(n,i){return function(t){var e=t.prototype;n.forEach(function(t){i(e,t)})}}(X,function(t,n){Object.defineProperty(t,n,{get:function(){return this.getPreactGuides().props[n]},set:function(t){var e;this.innerGuides.setState(((e={})[n]=t,e))},enumerable:!0,configurable:!0})})],t)}();return At.PROPERTIES=X,At});
//# sourceMappingURL=guides.min.js.map
